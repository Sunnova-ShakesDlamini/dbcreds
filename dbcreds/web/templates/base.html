<!-- dbcreds/web/templates/base.html -->
<!DOCTYPE html>
<html lang="en" class="h-full" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}{{ title }}{% endblock %}</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/static/favicon.ico">
    <link rel="icon" type="image/png" sizes="32x32" href="/static/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/static/favicon-16x16.png">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- HTMX -->
    <script src="https://unpkg.com/htmx.org@1.9.10"></script>
    
    <!-- Alpine.js for interactivity -->
    <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
    
    <!-- Custom styles -->
    <link rel="stylesheet" href="/static/css/custom.css">
    
    <!-- Theme detection script -->
    <script>
        // Check for saved theme or default to system preference
        const savedTheme = localStorage.getItem('theme') || 
            (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
        document.documentElement.setAttribute('data-theme', savedTheme);
    </script>
    
    <!-- Tailwind config -->
    <script>
        tailwind.config = {
            darkMode: ['class', '[data-theme="dark"]'],
            theme: {
                extend: {
                    colors: {
                        'dbcreds-blue': '#1E90FF',
                        'dbcreds-green': '#5AC85A',
                        'dbcreds-light-green': '#90EE90',
                        'dbcreds-dark-blue': '#2F3640',
                        'dbcreds-gray': '#C0C0C0',
                        'dbcreds-dark-gray': '#4B4B4B',
                        'dbcreds-teal': '#00b8a9',
                        'dbcreds-purple': '#6C5CE7',
                        'dbcreds-orange': '#FFA502',
                    }
                }
            }
        }
    </script>
    
    <style>
        [x-cloak] { display: none !important; }
    </style>
</head>
<body class="h-full transition-colors duration-300">
    <div class="min-h-full flex flex-col">
        <!-- Navigation -->
        <nav class="shadow-lg">
            <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
                <div class="flex h-16 justify-between">
                    <div class="flex">
                        <div class="flex flex-shrink-0 items-center">
                            <img src="/static/logo.svg" alt="dbcreds" class="h-8 w-8 mr-2 rounded-lg shadow-md">
                            <h1 class="text-xl font-bold text-white">dbcreds</h1>
                            <span class="ml-3 fast-mode-indicator">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                                </svg>
                                Fast Mode
                            </span>
                        </div>
                        <div class="hidden sm:ml-6 sm:flex sm:space-x-8">
                            <a href="/" class="text-white hover:text-gray-200 inline-flex items-center px-1 pt-1 text-sm font-medium transition-colors">
                                Environments
                            </a>
                            <a href="/settings" class="text-white hover:text-gray-200 inline-flex items-center px-1 pt-1 text-sm font-medium transition-colors">
                                Settings
                            </a>
                        </div>
                    </div>
                    <div class="flex items-center space-x-4">
                        <!-- Theme Toggle -->
                        <button onclick="toggleTheme()" class="theme-toggle" title="Toggle theme">
                            <svg class="w-5 h-5 hidden dark-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path>
                            </svg>
                            <svg class="w-5 h-5 light-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path>
                            </svg>
                            <span class="ml-2 hidden sm:inline">Theme</span>
                        </button>
                        <span class="text-sm text-gray-200">v{{ version }}</span>
                    </div>
                </div>
            </div>
        </nav>

        <!-- Main content -->
        <main class="flex-grow">
            <div class="mx-auto max-w-7xl py-6 sm:px-6 lg:px-8">
                {% block content %}{% endblock %}
            </div>
        </main>
        
        <!-- Footer -->
        <footer class="mt-auto py-4">
            <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 text-center">
                <p class="text-sm">
                    Made with ðŸ’š by <a href="https://github.com/Sunnova-ShakesDlamini" class="font-semibold hover:underline">Sunnova ShakesDlamini</a>
                </p>
                <div class="mt-2 space-x-4 text-xs">
                    <a href="https://github.com/Sunnova-ShakesDlamini/dbcreds" class="hover:underline">GitHub</a>
                    <a href="https://pypi.org/project/dbcreds/" class="hover:underline">PyPI</a>
                    <a href="https://sunnova-shakesdlamini.github.io/dbcreds/" class="hover:underline">Docs</a>
                </div>
            </div>
        </footer>
    </div>
    
    <!-- Notification container -->
    <div id="notification-container"></div>
    
    <script>
        // Theme management
        function toggleTheme() {
            const html = document.documentElement;
            const currentTheme = html.getAttribute('data-theme');
            const newTheme = currentTheme === 'light' ? 'dark' : 'light';
            
            html.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            updateThemeIcons();
        }
        
        function updateThemeIcons() {
            const theme = document.documentElement.getAttribute('data-theme');
            const darkIcon = document.querySelector('.dark-icon');
            const lightIcon = document.querySelector('.light-icon');
            
            if (theme === 'dark') {
                darkIcon.style.display = 'block';
                lightIcon.style.display = 'none';
            } else {
                darkIcon.style.display = 'none';
                lightIcon.style.display = 'block';
            }
        }
        
        // Initialize theme icons
        updateThemeIcons();
        
        // Listen for system theme changes
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', (e) => {
            if (!localStorage.getItem('theme')) {
                document.documentElement.setAttribute('data-theme', e.matches ? 'dark' : 'light');
                updateThemeIcons();
            }
        });
        
        // Notification system
        function showNotification(message, type = 'success', duration = 3000) {
            const container = document.getElementById('notification-container');
            
            const styles = {
                success: {
                    gradient: 'from-dbcreds-green to-green-600',
                    icon: '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>'
                },
                error: {
                    gradient: 'from-red-500 to-red-600',
                    icon: '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>'
                },
                warning: {
                    gradient: 'from-dbcreds-orange to-orange-600',
                    icon: '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>'
                },
                info: {
                    gradient: 'from-dbcreds-blue to-blue-600',
                    icon: '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>'
                }
            };
            
            const style = styles[type] || styles.success;
            
            const notification = document.createElement('div');
            notification.className = 'fixed top-4 right-4 z-50 animate-fade-in-down';
            notification.innerHTML = `
                <div class="bg-gradient-to-r ${style.gradient} text-white px-4 py-3 rounded-lg shadow-lg flex items-center space-x-3 max-w-md">
                    <svg class="h-5 w-5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        ${style.icon}
                    </svg>
                    <span class="font-medium">${message}</span>
                    <button onclick="this.parentElement.parentElement.remove()" class="ml-auto -mr-1 p-1 hover:opacity-75">
                        <svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>
            `;
            
            container.insertBefore(notification, container.firstChild);
            
            if (duration > 0) {
                setTimeout(() => {
                    if (notification.parentElement) {
                        notification.classList.add('animate-fade-out-up');
                        setTimeout(() => notification.remove(), 300);
                    }
                }, duration);
            }
        }
    </script>
</body>
</html>
